name: CI

on:
  pull_request:
  push:
    branches:
      - main

jobs:
  php-lint:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.1'

      - name: Lint custom PHP files
        shell: bash
        run: |
          set -euo pipefail
          php_files=$(find \
            site/wp-content/themes/child-flames-modern \
            -type f -name '*.php' 2>/dev/null || true)
          if [ -z "$php_files" ]; then
            echo "No PHP files found to lint"
            exit 0
          fi
          while IFS= read -r file; do
            php -l "$file"
          done <<< "$php_files"
